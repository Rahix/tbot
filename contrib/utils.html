

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tbot_contrib.utils &mdash; tbot 0.10.9-5-ga47582c documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5349f25f" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=8047a51e"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Changelog" href="../CHANGELOG.html" />
    <link rel="prev" title="tbot_contrib.uboot" href="uboot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/tbot-logo-white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">tbot CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pytest.html">pytest Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating from tbot 0.7.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/main.html"><code class="docutils literal notranslate"><span class="pre">tbot</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/log.html"><code class="docutils literal notranslate"><span class="pre">tbot.log</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine_linux.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.linux</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine_board.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.board</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine_connector.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.connector</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine_shell.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.shell</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/machine_channel.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.channel</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/error.html"><code class="docutils literal notranslate"><span class="pre">tbot.error</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/role.html"><code class="docutils literal notranslate"><span class="pre">tbot.role</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/selectable.html"><code class="docutils literal notranslate"><span class="pre">tbot.selectable</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testcase Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules/tc.html"><code class="docutils literal notranslate"><span class="pre">tbot.tc</span></code> - Builtin Testcases</a></li>
<li class="toctree-l1"><a class="reference internal" href="connector.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.connector</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="gdb.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.gdb</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.gpio</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="linux.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.linux</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="locking.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.locking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="swupdate.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.swupdate</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="timing.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.timing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="uboot.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.uboot</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.utils</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.ensure_sd_unit"><code class="docutils literal notranslate"><span class="pre">ensure_sd_unit()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.find_ip_address"><code class="docutils literal notranslate"><span class="pre">find_ip_address()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.hashcmp"><code class="docutils literal notranslate"><span class="pre">hashcmp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.copy_to_dir"><code class="docutils literal notranslate"><span class="pre">copy_to_dir()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.find_block_partitions"><code class="docutils literal notranslate"><span class="pre">find_block_partitions()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tbot_contrib.utils.strip_ansi_escapes"><code class="docutils literal notranslate"><span class="pre">strip_ansi_escapes()</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to tbot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.utils</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/contrib/utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <section id="tbot-contrib-utils">
<span id="module-tbot_contrib.utils"></span><h1><code class="docutils literal notranslate"><span class="pre">tbot_contrib.utils</span></code><a class="headerlink" href="#tbot-contrib-utils" title="Link to this heading">Â¶</a></h1>
<p>Various testcases.</p>
<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.ensure_sd_unit">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_sd_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lnx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.linux_shell.LinuxShell"><span class="pre">LinuxShell</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">services</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#ensure_sd_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.ensure_sd_unit" title="Link to this definition">Â¶</a></dt>
<dd><p>check if all systemd services in list services run on linux machine lnx.
If not, try to start them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lnx</strong> â linux shell</p></li>
<li><p><strong>services</strong> â list of systemd services</p></li>
</ul>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.8.3.</span></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.find_ip_address">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">find_ip_address</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lnx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.linux_shell.LinuxShell"><span class="pre">LinuxShell</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#find_ip_address"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.find_ip_address" title="Link to this definition">Â¶</a></dt>
<dd><p>Find out an IP-address of a host.</p>
<p>In times where most hosts have many IP addresses, this is not as trivial as
one would like.  This testcase approaches the problem by trying to find the
IP-address, the host would use on a certain route.</p>
<p>By default, this is the route to reach a theoretical host at <code class="docutils literal notranslate"><span class="pre">1.0.0.0</span></code>.
This will yield a sensible result in <em>most</em> cases but of course will not
always be the address you want.  For more fine-grained control you can pass
a <code class="docutils literal notranslate"><span class="pre">route_target</span></code>.  This is the IP-address of this theoretical host to reach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lnx</strong> (<a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.LinuxShell"><em>linux.LinuxShell</em></a>) â The host to work on.</p></li>
<li><p><strong>route_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) â An optional route target.  Defaults to <code class="docutils literal notranslate"><span class="pre">1.0.0.0</span></code>.</p></li>
<li><p><strong>force</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â By default, this testcase caches results for faster
lookup when called multiple times.  This parameter enforces a re-check
which might be useful when the network configuration on <code class="docutils literal notranslate"><span class="pre">lnx</span></code>
changed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The IP-address which was found.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.8.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.2: </span>Fixed <code class="docutils literal notranslate"><span class="pre">find_ip_address()</span></code> not working properly when the route target
is a local address.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.hashcmp">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">hashcmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#hashcmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.hashcmp" title="Link to this definition">Â¶</a></dt>
<dd><p>Compare the hashsum of two files (potentially from different hosts).</p>
<p><code class="docutils literal notranslate"><span class="pre">hashcmp()</span></code> automatically selects a hash-summing tool which is available
on both hosts and uses it to compare the checksum of the two files.  It
returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if they match and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.  If one of the
files does not exist, <code class="docutils literal notranslate"><span class="pre">False</span></code> is returned.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.9.2.</span></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.copy_to_dir">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">copy_to_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sources</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H1</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H2</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashcmp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H2</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#copy_to_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.copy_to_dir" title="Link to this definition">Â¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">copy_to_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sources</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H1</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H2</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashcmp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H2</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Copy one or more files to a directory</p>
<p>This function will copy each file from <code class="docutils literal notranslate"><span class="pre">sources</span></code> into a new file in
<code class="docutils literal notranslate"><span class="pre">dest_dir</span></code> which has the same name as the original one.</p>
<p>This function uses <a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.copy" title="tbot.machine.linux.copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">linux.copy()</span></code></a> under
the hood so <code class="docutils literal notranslate"><span class="pre">sources</span></code> and <code class="docutils literal notranslate"><span class="pre">dest_dir</span></code> need not be on the same host.  See
that function for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sources</strong> â The file(s) to copy.  This may be a single
<a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> or an iterable which yields zero
or more <a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> objects.</p></li>
<li><p><strong>dest_dir</strong> (<a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.Path"><em>linux.Path</em></a>) â The target directory where the files should be
copied to.  It does not need to be on the same host as <code class="docutils literal notranslate"><span class="pre">sources</span></code>.</p></li>
<li><p><strong>hashcmp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â This optional named argument can be set to true to
make the function verify checksums of each file before performing the
copy. This is very useful to skip superfluous copying operations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If a single <code class="docutils literal notranslate"><span class="pre">sources</span></code> path was passed, a single path is
returned which points to the newly created copy.  If multiple
<code class="docutils literal notranslate"><span class="pre">sources</span></code> were passed (as an iterable), a list of paths for each
copied file is returned.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.10.2.</span></p>
</div>
<p><strong>Example</strong>: Copy a file from lab-host to a tftp-server for serving it to a
target device.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot_contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>

<span class="n">linux_sources</span> <span class="o">=</span> <span class="n">lh</span><span class="o">.</span><span class="n">workdir</span> <span class="o">/</span> <span class="s2">&quot;linux&quot;</span>

<span class="n">tftp_zimage</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">copy_to_dir</span><span class="p">(</span>
    <span class="n">linux_sources</span> <span class="o">/</span> <span class="s2">&quot;arch/arm/boot/zImage&quot;</span><span class="p">,</span>
    <span class="n">tftp_server</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">,</span>
    <span class="n">hashcmp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">tftp_filename</span> <span class="o">=</span> <span class="n">tftp_zimage</span><span class="o">.</span><span class="n">name</span>

<span class="n">u_boot</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;tftp&quot;</span><span class="p">,</span> <span class="s2">&quot;0x10000000&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tftp_server</span><span class="o">.</span><span class="n">addr</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tftp_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example</strong>: Copy many files from lab-host to a tftp-server for serving
them to a target device.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot_contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>

<span class="n">linux_sources</span> <span class="o">=</span> <span class="n">lh</span><span class="o">.</span><span class="n">workdir</span> <span class="o">/</span> <span class="s2">&quot;linux&quot;</span>

<span class="n">utils</span><span class="o">.</span><span class="n">copy_to_dir</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">linux_sources</span> <span class="o">/</span> <span class="s2">&quot;arch/arm/boot/zImage&quot;</span><span class="p">,</span>
        <span class="n">linux_sources</span> <span class="o">/</span> <span class="s2">&quot;arch/arm/boot/dts/mydevice.dtb&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">tftp_server</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">,</span>
    <span class="n">hashcmp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Example</strong>: Copy all config files to a new directory and then run a
replacement command on each one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot_contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>

<span class="n">config_dir</span> <span class="o">=</span> <span class="n">lnx</span><span class="o">.</span><span class="n">fsroot</span> <span class="o">/</span> <span class="s2">&quot;etc&quot;</span> <span class="o">/</span> <span class="s2">&quot;myapp&quot;</span>
<span class="n">newconfig_dir</span> <span class="o">=</span> <span class="n">lnx</span><span class="o">.</span><span class="n">workdir</span> <span class="o">/</span> <span class="s2">&quot;newconfig&quot;</span>
<span class="n">lnx</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;-rf&quot;</span><span class="p">,</span> <span class="n">newconfig_dir</span><span class="p">)</span>
<span class="n">lnx</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="n">newconfig_dir</span><span class="p">)</span>

<span class="n">new_cfg_files</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">copy_to_dir</span><span class="p">(</span>
    <span class="n">config_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.conf&quot;</span><span class="p">),</span>
    <span class="n">newconfig_dir</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">cfg_file</span> <span class="ow">in</span> <span class="n">new_cfg_files</span><span class="p">:</span>
    <span class="n">lnx</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;sed&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="s2">&quot;s/eth0/wlan0/g&quot;</span><span class="p">,</span> <span class="n">cfg_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.find_block_partitions">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">find_block_partitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.path.Path"><span class="pre">Path</span></a><span class="p"><span class="pre">[</span></span><span class="pre">H</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#find_block_partitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.find_block_partitions" title="Link to this definition">Â¶</a></dt>
<dd><p>Find all partitions of a given block device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> (<a class="reference internal" href="../modules/machine_linux.html#tbot.machine.linux.Path" title="tbot.machine.linux.Path"><em>linux.Path</em></a>) â The block device whose partitions should be found.</p></li>
<li><p><strong>include_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â Whether to include the block device itself in the
partition list as well.  Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An iterator over path objects for all partitions of the block device.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.10.5.</span></p>
</div>
<p><strong>Example</strong>: Unmount all partitions before writing a new image
to the device.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot_contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>

<span class="n">blkdev</span> <span class="o">=</span> <span class="n">lnx</span><span class="o">.</span><span class="n">fsroot</span> <span class="o">/</span> <span class="s2">&quot;dev&quot;</span> <span class="o">/</span> <span class="s2">&quot;sdb&quot;</span>
<span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_block_partitions</span><span class="p">(</span><span class="n">blkdev</span><span class="p">):</span>
    <span class="c1"># Ignore errors...</span>
    <span class="n">lnx</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;umount&quot;</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tbot_contrib.utils.strip_ansi_escapes">
<span class="sig-prename descclassname"><span class="pre">tbot_contrib.utils.</span></span><span class="sig-name descname"><span class="pre">strip_ansi_escapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/tbot_contrib/utils.html#strip_ansi_escapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot_contrib.utils.strip_ansi_escapes" title="Link to this definition">Â¶</a></dt>
<dd><p>Strip all ANSI escape sequences from a string</p>
<p>This helper can be used when programs have colored output and piping with
<code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">cat</span></code> doesnât help (e.g. forced color as with <code class="docutils literal notranslate"><span class="pre">--color=always</span></code>).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.9.2.</span></p>
</div>
</dd></dl>

</section>


           </div>
          </div>
    <a href="https://github.com/Rahix/tbot">
        <img style="position: absolute; top: 0; right: 0; border: 0;" decoding="async" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" loading="lazy" data-recalc-dims="1">
    </a>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="uboot.html" class="btn btn-neutral float-left" title="tbot_contrib.uboot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../CHANGELOG.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Rahix.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>