

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tbot.machine.connector &mdash; tbot 0.10.9-5-ga47582c documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5349f25f" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=8047a51e"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tbot.machine.shell" href="machine_shell.html" />
    <link rel="prev" title="tbot.machine.board" href="machine_board.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/tbot-logo-white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">tbot CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pytest.html">pytest Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating from tbot 0.7.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html"><code class="docutils literal notranslate"><span class="pre">tbot</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html"><code class="docutils literal notranslate"><span class="pre">tbot.log</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="machine.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="machine_linux.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.linux</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="machine_board.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.board</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">tbot.machine.connector</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#provided-connectors">Provided Connectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subprocess">Subprocess</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.SubprocessConnector"><code class="docutils literal notranslate"><span class="pre">SubprocessConnector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#paramiko">Paramiko</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.ParamikoConnector"><code class="docutils literal notranslate"><span class="pre">ParamikoConnector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serial-console">Serial Console</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.ConsoleConnector"><code class="docutils literal notranslate"><span class="pre">ConsoleConnector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plain-ssh">Plain SSH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.SSHConnector"><code class="docutils literal notranslate"><span class="pre">SSHConnector</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#base-class">Base-Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tbot.machine.connector.Connector"><code class="docutils literal notranslate"><span class="pre">Connector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.Connector._connect"><code class="docutils literal notranslate"><span class="pre">Connector._connect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.Connector.from_context"><code class="docutils literal notranslate"><span class="pre">Connector.from_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tbot.machine.connector.Connector.clone"><code class="docutils literal notranslate"><span class="pre">Connector.clone()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="machine_shell.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.shell</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="machine_channel.html"><code class="docutils literal notranslate"><span class="pre">tbot.machine.channel</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="error.html"><code class="docutils literal notranslate"><span class="pre">tbot.error</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="role.html"><code class="docutils literal notranslate"><span class="pre">tbot.role</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="selectable.html"><code class="docutils literal notranslate"><span class="pre">tbot.selectable</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testcase Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tc.html"><code class="docutils literal notranslate"><span class="pre">tbot.tc</span></code> - Builtin Testcases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/connector.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.connector</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/gdb.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.gdb</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/gpio.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.gpio</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/linux.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.linux</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/locking.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.locking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/swupdate.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.swupdate</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/timing.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.timing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/uboot.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.uboot</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/utils.html"><code class="docutils literal notranslate"><span class="pre">tbot_contrib.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to tbot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">tbot.machine.connector</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/machine_connector.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <section id="tbot-machine-connector">
<span id="module-tbot.machine.connector"></span><h1><code class="docutils literal notranslate"><span class="pre">tbot.machine.connector</span></code><a class="headerlink" href="#tbot-machine-connector" title="Link to this heading">¶</a></h1>
<p>Connectors are one of the three parts of a machine:  The connector is
responsible for establishing the initial channel for a machine.  This can work
in many different ways, either a simple subprocess, an ssh-connection, a
serial-console device, or a telnet session.</p>
<p>All connectors should inherit from the
<a class="reference internal" href="#tbot.machine.connector.Connector" title="tbot.machine.connector.Connector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connector</span></code></a> base-class.</p>
<section id="provided-connectors">
<h2>Provided Connectors<a class="headerlink" href="#provided-connectors" title="Link to this heading">¶</a></h2>
<p>For a lot of commonly used cases, tbot already has connectors at hand.  These
are:</p>
<section id="subprocess">
<h3>Subprocess<a class="headerlink" href="#subprocess" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tbot.machine.connector.SubprocessConnector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tbot.machine.connector.</span></span><span class="sig-name descname"><span class="pre">SubprocessConnector</span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#SubprocessConnector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SubprocessConnector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tbot.machine.connector.Connector" title="tbot.machine.connector.connector.Connector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connector</span></code></a></p>
<p>Connector using a subprocess shell.</p>
<p>Arguably the simplest connector; simply spawns a subprocess with a shell.
This is the connector used by the default local lab-host.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot.machine</span><span class="w"> </span><span class="kn">import</span> <span class="n">connector</span><span class="p">,</span> <span class="n">linux</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyMachine</span><span class="p">(</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">SubprocessConnector</span><span class="p">,</span>
    <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">pass</span>

<span class="k">with</span> <span class="n">MyMachine</span><span class="p">()</span> <span class="k">as</span> <span class="n">localhost</span><span class="p">:</span>
    <span class="n">localhost</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.SubprocessConnector.from_context">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="main.html#tbot.Context" title="tbot.context.Context"><span class="pre">Context</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><span class="pre">M</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#SubprocessConnector.from_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SubprocessConnector.from_context" title="Link to this definition">¶</a></dt>
<dd><p>Create this machine from a tbot context.</p>
<p>This method defines how tbot can automatically attempt creating this
machine from a given context. It is usually defined by the connector
but might be overridden by board config in certain more complex
scenarios.</p>
<p>This method must return a context-manager that, upon entering, yields a
<strong>fully initialized</strong> machine. In practical terms this means, the
implementation must enter the “machine’s context” as well. As an
example, the most basic implementation would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="c1"># Create instance and enter its context, in this example, no</span>
    <span class="c1"># args are passed to the constructor ...</span>
    <span class="k">with</span> <span class="bp">cls</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">m</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.SubprocessConnector.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">M</span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#SubprocessConnector.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SubprocessConnector.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clone this machine.</p>
</dd></dl>

</dd></dl>

</section>
<section id="paramiko">
<h3>Paramiko<a class="headerlink" href="#paramiko" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tbot.machine.connector.</span></span><span class="sig-name descname"><span class="pre">ParamikoConnector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tbot.machine.connector.ParamikoConnector" title="tbot.machine.connector.paramiko.ParamikoConnector"><span class="pre">ParamikoConnector</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tbot/machine/connector/paramiko.html#ParamikoConnector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tbot.machine.connector.Connector" title="tbot.machine.connector.connector.Connector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connector</span></code></a></p>
<p>Connect to an ssh server using <a class="reference external" href="https://www.paramiko.org/">Paramiko</a>.</p>
<p>When inheriting from this connector, you should overwrite the attributes
documented below to make it connect to your remote.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tbot.machine</span><span class="w"> </span><span class="kn">import</span> <span class="n">connector</span><span class="p">,</span> <span class="n">linux</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyMachine</span><span class="p">(</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">ParamikoConnector</span><span class="p">,</span>
    <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;78.79.32.85&quot;</span>
    <span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;tbot-user&quot;</span>

<span class="k">with</span> <span class="n">MyMachine</span><span class="p">()</span> <span class="k">as</span> <span class="n">remotehost</span><span class="p">:</span>
    <span class="n">remotehost</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;uname&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#tbot.machine.connector.ParamikoConnector" title="tbot.machine.connector.ParamikoConnector"><em>ParamikoConnector</em></a>) – Build this connection by opening a new
channel in an existing ssh-connection.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.hostname">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hostname</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.hostname" title="Link to this definition">¶</a></dt>
<dd><p>Hostname of this remote.</p>
<p>You must always specify this parameter in your Lab config!</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.username">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">username</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.username" title="Link to this definition">¶</a></dt>
<dd><p>Username to log in as.</p>
<p>Defaults to the username from <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> or the local username.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.authenticator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">authenticator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.PasswordAuthenticator" title="tbot.machine.linux.auth.PasswordAuthenticator"><span class="pre">PasswordAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.PrivateKeyAuthenticator" title="tbot.machine.linux.auth.PrivateKeyAuthenticator"><span class="pre">PrivateKeyAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.NoneAuthenticator" title="tbot.machine.linux.auth.NoneAuthenticator"><span class="pre">NoneAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UndefinedAuthenticator</span></em><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.authenticator" title="Link to this definition">¶</a></dt>
<dd><p>Return an authenticator that allows logging in on this machine.</p>
<p>See <a class="reference internal" href="machine_linux.html#module-tbot.machine.linux.auth" title="tbot.machine.linux.auth"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tbot.machine.linux.auth</span></code></a> for available authenticators.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tbot.machine.linux.auth.Authenticator</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.port">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">port</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.port" title="Link to this definition">¶</a></dt>
<dd><p>Port the remote SSH server is listening on.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">22</span></code> or the value of <code class="docutils literal notranslate"><span class="pre">Port</span></code> in <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.ignore_hostkey">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ignore_hostkey</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.ignore_hostkey" title="Link to this definition">¶</a></dt>
<dd><p>Ignore remote host key.</p>
<p>Set this to true if the remote changes its host key often.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code> or the value of <code class="docutils literal notranslate"><span class="pre">StrictHostKeyChecking</span></code> in
<code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.from_context">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="main.html#tbot.Context" title="tbot.context.Context"><span class="pre">Context</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Self</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/paramiko.html#ParamikoConnector.from_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.from_context" title="Link to this definition">¶</a></dt>
<dd><p>Create this machine from a tbot context.</p>
<p>This method defines how tbot can automatically attempt creating this
machine from a given context. It is usually defined by the connector
but might be overridden by board config in certain more complex
scenarios.</p>
<p>This method must return a context-manager that, upon entering, yields a
<strong>fully initialized</strong> machine. In practical terms this means, the
implementation must enter the “machine’s context” as well. As an
example, the most basic implementation would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="c1"># Create instance and enter its context, in this example, no</span>
    <span class="c1"># args are passed to the constructor ...</span>
    <span class="k">with</span> <span class="bp">cls</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">m</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.ParamikoConnector.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/paramiko.html#ParamikoConnector.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ParamikoConnector.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clone this machine.</p>
<p>Note that an ssh-session cannot hold an unlimited number of channels so
cloning too much might lead to issues.  The exact limit is dependent on
the server configuration.</p>
</dd></dl>

</dd></dl>

</section>
<section id="serial-console">
<h3>Serial Console<a class="headerlink" href="#serial-console" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tbot.machine.connector.ConsoleConnector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tbot.machine.connector.</span></span><span class="sig-name descname"><span class="pre">ConsoleConnector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.linux_shell.LinuxShell"><span class="pre">LinuxShell</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#ConsoleConnector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ConsoleConnector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tbot.machine.connector.Connector" title="tbot.machine.connector.connector.Connector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connector</span></code></a></p>
<p>Connector for serial-consoles.</p>
<p>As this can work in many different ways, this connector is intentionally as
generic as possible.  To configure a serial connection, you need to
implement the <a class="reference internal" href="#tbot.machine.connector.ConsoleConnector.connect" title="tbot.machine.connector.ConsoleConnector.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConsoleConnector.connect()</span></code></a> method.  That methods
gets a lab-host channel which it should transform into a channel connected
to the board’s serial console.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tbot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tbot.machine</span><span class="w"> </span><span class="kn">import</span> <span class="n">board</span><span class="p">,</span> <span class="n">connector</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyBoard</span><span class="p">(</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">ConsoleConnector</span><span class="p">,</span>
    <span class="n">board</span><span class="o">.</span><span class="n">Board</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mach</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mach</span><span class="o">.</span><span class="n">open_channel</span><span class="p">(</span><span class="s2">&quot;picocom&quot;</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="s2">&quot;115200&quot;</span><span class="p">,</span> <span class="s2">&quot;/dev/ttyACM0&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">tbot</span><span class="o">.</span><span class="n">acquire_local</span><span class="p">()</span> <span class="k">as</span> <span class="n">lo</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">MyBoard</span><span class="p">(</span><span class="n">lo</span><span class="p">)</span> <span class="k">as</span> <span class="n">b</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mach</strong> (<a class="reference internal" href="machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.LinuxShell"><em>LinuxShell</em></a>) – A cloneable lab-host machine.  The
<a class="reference internal" href="#tbot.machine.connector.ConsoleConnector" title="tbot.machine.connector.ConsoleConnector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConsoleConnector</span></code></a> will try to clone this machine’s
connection and use that to connect to the board.  This means that
you have to make sure you give the correct lab-host for your
respective board to the constructor here.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.ConsoleConnector.connect">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.linux_shell.LinuxShell"><span class="pre">LinuxShell</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ContextManager" title="(in Python v3.13)"><span class="pre">ContextManager</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="machine_channel.html#tbot.machine.channel.Channel" title="tbot.machine.channel.channel.Channel"><span class="pre">Channel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#ConsoleConnector.connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ConsoleConnector.connect" title="Link to this definition">¶</a></dt>
<dd><p>Connect a machine to the serial console.</p>
<p>Overwrite this method with the necessary logic to connect the given
machine <code class="docutils literal notranslate"><span class="pre">mach</span></code> to a channel connected to the board’s serial console.</p>
<p>In most cases you’ll accomplish this using
<a class="reference internal" href="machine_linux.html#tbot.machine.linux.LinuxShell.open_channel" title="tbot.machine.linux.LinuxShell.open_channel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mach.open_channel(...)</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.ConsoleConnector.from_context">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="main.html#tbot.Context" title="tbot.context.Context"><span class="pre">Context</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><span class="pre">M</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#ConsoleConnector.from_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ConsoleConnector.from_context" title="Link to this definition">¶</a></dt>
<dd><p>Create this machine from a tbot context.</p>
<p>This method defines how tbot can automatically attempt creating this
machine from a given context. It is usually defined by the connector
but might be overridden by board config in certain more complex
scenarios.</p>
<p>This method must return a context-manager that, upon entering, yields a
<strong>fully initialized</strong> machine. In practical terms this means, the
implementation must enter the “machine’s context” as well. As an
example, the most basic implementation would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="c1"># Create instance and enter its context, in this example, no</span>
    <span class="c1"># args are passed to the constructor ...</span>
    <span class="k">with</span> <span class="bp">cls</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">m</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.ConsoleConnector.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">M</span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/common.html#ConsoleConnector.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.ConsoleConnector.clone" title="Link to this definition">¶</a></dt>
<dd><p>This machine is <strong>not</strong> cloneable.</p>
</dd></dl>

</dd></dl>

</section>
<section id="plain-ssh">
<h3>Plain SSH<a class="headerlink" href="#plain-ssh" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tbot.machine.connector.</span></span><span class="sig-name descname"><span class="pre">SSHConnector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="machine_linux.html#tbot.machine.linux.LinuxShell" title="tbot.machine.linux.linux_shell.LinuxShell"><span class="pre">LinuxShell</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tbot/machine/connector/ssh.html#SSHConnector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SSHConnector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tbot.machine.connector.Connector" title="tbot.machine.connector.connector.Connector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connector</span></code></a></p>
<p>Connect to remote using <code class="docutils literal notranslate"><span class="pre">ssh</span></code> by starting off from an existing machine.</p>
<p>An <a class="reference internal" href="#tbot.machine.connector.SSHConnector" title="tbot.machine.connector.SSHConnector"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSHConnector</span></code></a> is different from a
<a class="reference internal" href="#tbot.machine.connector.ParamikoConnector" title="tbot.machine.connector.ParamikoConnector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamikoConnector</span></code></a> as it requires an existing machine to start
the connection from.  This allows jumping via one host to a second.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tbot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tbot.machine</span><span class="w"> </span><span class="kn">import</span> <span class="n">connector</span><span class="p">,</span> <span class="n">linux</span>

<span class="c1"># Connect into a container running on the (possibly remote) lab-host</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyRemote</span><span class="p">(</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">SSHConnector</span><span class="p">,</span>
    <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">20220</span>
    <span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;root&quot;</span>

<span class="k">with</span> <span class="n">tbot</span><span class="o">.</span><span class="n">acquire_lab</span><span class="p">()</span> <span class="k">as</span> <span class="n">lh</span><span class="p">:</span>
    <span class="c1"># lh might be a ParamikoConnector machine.</span>
    <span class="k">with</span> <span class="n">MyRemote</span><span class="p">(</span><span class="n">lh</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssh_session</span><span class="p">:</span>
        <span class="n">ssh_session</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;uptime&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.ignore_hostkey">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ignore_hostkey</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.ignore_hostkey" title="Link to this definition">¶</a></dt>
<dd><p>Ignore host key.</p>
<p>Set this to true if the remote changes its host key often.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.use_multiplexing">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">use_multiplexing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.use_multiplexing" title="Link to this definition">¶</a></dt>
<dd><p>Whether tbot should attempt to enable connection multiplexing.</p>
<p>Connection multiplexing is a mechanism to share a connection between
multiple sessions.  This can drastically speed up your tests when many
connections to the same machine are opened and closed.  Refer to
<a class="reference external" href="https://man.openbsd.org/ssh_config.5#ControlMaster">ControlMaster in sshd_config(5)</a> for details.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.9.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.hostname">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hostname</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.hostname" title="Link to this definition">¶</a></dt>
<dd><p>Return the hostname of this machine.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.username">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">username</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.username" title="Link to this definition">¶</a></dt>
<dd><p>Return the username for logging in on this machine.</p>
<p>Defaults to the username on the labhost.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.authenticator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">authenticator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.PasswordAuthenticator" title="tbot.machine.linux.auth.PasswordAuthenticator"><span class="pre">PasswordAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.PrivateKeyAuthenticator" title="tbot.machine.linux.auth.PrivateKeyAuthenticator"><span class="pre">PrivateKeyAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="machine_linux.html#tbot.machine.linux.auth.NoneAuthenticator" title="tbot.machine.linux.auth.NoneAuthenticator"><span class="pre">NoneAuthenticator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UndefinedAuthenticator</span></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.authenticator" title="Link to this definition">¶</a></dt>
<dd><p>Return an authenticator that allows logging in on this machine.</p>
<p>See <a class="reference internal" href="machine_linux.html#module-tbot.machine.linux.auth" title="tbot.machine.linux.auth"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tbot.machine.linux.auth</span></code></a> for available authenticators.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>It is strongly advised to use key authentication.  If you use password
auth, <strong>THE PASSWORD WILL BE LEAKED</strong> and <strong>MIGHT EASILY BE STOLEN</strong>
by other users on your labhost.  It will also be visible in the log file.</p>
<p>If you decide to use this, you’re doing this on your own risk.</p>
<p>The only case where I support using passwords is when connecting to
a test board with a default password.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tbot.machine.linux.auth.Authenticator</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.port">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">port</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.port" title="Link to this definition">¶</a></dt>
<dd><p>Return the port the SSH server is listening on.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.ssh_config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ssh_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tbot.machine.connector.SSHConnector.ssh_config" title="Link to this definition">¶</a></dt>
<dd><p>Add additional ssh config options when connecting.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MySSHMach</span><span class="p">(</span><span class="n">connector</span><span class="o">.</span><span class="n">SSHConnector</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">):</span>
    <span class="n">ssh_config</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ProxyJump=foo@example.com&quot;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>)</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.6.2.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.from_context">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="main.html#tbot.Context" title="tbot.context.Context"><span class="pre">Context</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Self</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/ssh.html#SSHConnector.from_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SSHConnector.from_context" title="Link to this definition">¶</a></dt>
<dd><p>Create this machine from a tbot context.</p>
<p>This method defines how tbot can automatically attempt creating this
machine from a given context. It is usually defined by the connector
but might be overridden by board config in certain more complex
scenarios.</p>
<p>This method must return a context-manager that, upon entering, yields a
<strong>fully initialized</strong> machine. In practical terms this means, the
implementation must enter the “machine’s context” as well. As an
example, the most basic implementation would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="c1"># Create instance and enter its context, in this example, no</span>
    <span class="c1"># args are passed to the constructor ...</span>
    <span class="k">with</span> <span class="bp">cls</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">m</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.SSHConnector.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tbot.machine.connector.SSHConnector" title="tbot.machine.connector.ssh.SSHConnector"><span class="pre">SSHConnector</span></a></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/ssh.html#SSHConnector.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.SSHConnector.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clone this machine.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="base-class">
<h2>Base-Class<a class="headerlink" href="#base-class" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tbot.machine.connector.Connector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tbot.machine.connector.</span></span><span class="sig-name descname"><span class="pre">Connector</span></span><a class="reference internal" href="../_modules/tbot/machine/connector/connector.html#Connector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.Connector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="machine.html#tbot.machine.Machine" title="tbot.machine.machine.Machine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Machine</span></code></a></p>
<p>Base-class for machine connectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.Connector._connect">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_connect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ContextManager" title="(in Python v3.13)"><span class="pre">ContextManager</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="machine_channel.html#tbot.machine.channel.Channel" title="tbot.machine.channel.channel.Channel"><span class="pre">Channel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/connector.html#Connector._connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.Connector._connect" title="Link to this definition">¶</a></dt>
<dd><p>Establish the channel.</p>
<p>This method will be called during machine-initialization and should
yield a channel which will then be used for the machine.</p>
<p>This method’s return type is annotated as
<code class="docutils literal notranslate"><span class="pre">typing.ContextManager[channel.Channel]</span></code>, to allow more complex setup
&amp; teardown.  As channels implement the context-manager protocol, simple
connectors can just return the channel.  A more complex connector can
use the following pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">contextlib</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyConnector</span><span class="p">(</span><span class="n">Connector</span><span class="p">):</span>
    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">channel</span><span class="o">.</span><span class="n">Channel</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Do setup</span>
            <span class="o">...</span>
            <span class="k">yield</span> <span class="n">ch</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Do teardown</span>
            <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.Connector.from_context">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="main.html#tbot.Context" title="tbot.context.Context"><span class="pre">Context</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ContextManager" title="(in Python v3.13)"><span class="pre">ContextManager</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Self</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/connector.html#Connector.from_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.Connector.from_context" title="Link to this definition">¶</a></dt>
<dd><p>Create this machine from a tbot context.</p>
<p>This method defines how tbot can automatically attempt creating this
machine from a given context. It is usually defined by the connector
but might be overridden by board config in certain more complex
scenarios.</p>
<p>This method must return a context-manager that, upon entering, yields a
<strong>fully initialized</strong> machine. In practical terms this means, the
implementation must enter the “machine’s context” as well. As an
example, the most basic implementation would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="c1"># Create instance and enter its context, in this example, no</span>
    <span class="c1"># args are passed to the constructor ...</span>
    <span class="k">with</span> <span class="bp">cls</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">m</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tbot.machine.connector.Connector.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/tbot/machine/connector/connector.html#Connector.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbot.machine.connector.Connector.clone" title="Link to this definition">¶</a></dt>
<dd><p>Create a duplicate of this machine.</p>
<p>For a lot of connections, it is trivial to open a second one in
parallel.  This can be exploited to easily connect further from one
host to the next, thus building a tunnel.</p>
<p>On the other hand, a serial connection to a board is unique and can’t
be cloned.  Such connectors should raise an exception is <code class="docutils literal notranslate"><span class="pre">.clone()</span></code>
is called.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Important</strong>: You should <strong>always</strong> set the new machines <code class="docutils literal notranslate"><span class="pre">_orig</span></code>
attribute to the original machine (either <code class="docutils literal notranslate"><span class="pre">self._orig</span></code> or, if
that is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code>) so tbot knows these machines belong
together!  The common pattern is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">new</span><span class="o">.</span><span class="n">_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig</span> <span class="ow">or</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">new</span>
</pre></div>
</div>
<p>Not setting <code class="docutils literal notranslate"><span class="pre">_orig</span></code> means that tbot will treat the new and old
instances as separate machines which (theoretically) can’t interact
with each other.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
    <a href="https://github.com/Rahix/tbot">
        <img style="position: absolute; top: 0; right: 0; border: 0;" decoding="async" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" loading="lazy" data-recalc-dims="1">
    </a>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="machine_board.html" class="btn btn-neutral float-left" title="tbot.machine.board" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="machine_shell.html" class="btn btn-neutral float-right" title="tbot.machine.shell" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Rahix.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>